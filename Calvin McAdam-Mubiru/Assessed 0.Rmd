## Introduction

The following document contains code and data retrieved from an [article](https://towardsdatascience.com/democratizing-historical-weather-data-with-r-cc3c76dde7c%3E5) to do with analysing data on the weather. The specific example is on the US and Portland International Airport between 1941 and 2021.

The following pre-requisites are required and this block should be run first so that the suitable packages are loaded in.

```{r}
library(tidyverse)
library(lubridate)
library(ggthemes)
library(ggtext)
```

We also had to find and import the data we will be working with in the example:

```{r}
csv_data <- read_csv('https://raw.githubusercontent.com/wpbSabi/weather/main/towardsDS/weather_towardsds.csv')
str(csv_data)
```

## Date range for station

```{r}
csv_data %>% 
  filter(NAME == 'PORTLAND INTERNATIONAL AIRPORT, OR US') %>%
  select(NAME, DATE) %>%
  group_by(NAME) %>%
  summarise('min_date' = min(DATE), 'max_date' = max(DATE))
```

## What one day had the most rainfall/snowfall and how many inches of rain/snow were measured that day?

```{r}
weather_data <- csv_data %>%
  filter(DATE > '1940-12-31' & DATE < '2021-01-01')

max_daily_rainfall <- max(weather_data$PRCP, na.rm = TRUE)
max_daily_snowfall <- max(weather_data$SNOW, na.rm = TRUE)
weather_data %>% filter(PRCP == max_daily_rainfall | 
                          SNOW == max_daily_snowfall)
```

# Rainfall monthly box-and-whisker plot

```{r}
rain_monthly <- weather_data %>%
  filter(is.na(PRCP) == FALSE) %>%
  mutate(YEAR = year(DATE), MONTH = month(DATE), MONTH_ABB = month.abb[MONTH]) %>%
  select(YEAR,MONTH,MONTH_ABB,RAINFALL=PRCP) %>%
  group_by(YEAR,MONTH,MONTH_ABB) %>%
  summarise(sum(RAINFALL))

ggplot() +
  geom_boxplot(data=rain_monthly
               , mapping = aes(x=reorder(MONTH_ABB,MONTH), 
                               y=`sum(RAINFALL)`, group=MONTH_ABB)) +
  theme_economist_white() + 
  theme( plot.title.position = "panel"
         ,plot.title = element_textbox_simple(
           size = 13,
           lineheight = 1,
           padding = margin(5.5, 5.5, 5.5, 5.5),
           margin = margin(0, 0, 5.5, 0))
         ,panel.grid.major = element_blank()
         ,panel.grid.minor = element_blank()
         ,legend.title = element_blank() ) +
  ggtitle("<b>Rainfall by Month at PDX Airport (since 1941) </b>") +
  labs(caption = "Data: National Centers for Environmental Information") +
  xlab('') +
  ylab('Monthly Rainfall (inches)\n')
```

## Modified Code

```{r}
rain_monthly <- weather_data %>%
  filter(is.na(PRCP) == FALSE) %>%
  mutate(YEAR = year(DATE), MONTH = month(DATE), MONTH_ABB = month.abb[MONTH]) %>%
  select(YEAR,MONTH,MONTH_ABB,RAINFALL=PRCP) %>%
  group_by(YEAR,MONTH,MONTH_ABB) %>%
  summarise(sum(RAINFALL))
ggplot() +
  geom_boxplot(data=rain_monthly
               , fill = 'green',mapping = aes(x=reorder(MONTH_ABB,MONTH), 
                               y=`sum(RAINFALL)`, group=MONTH_ABB)) +
 theme( plot.title.position = "panel"
         ,plot.title = element_textbox_simple(
           size = 13,
           lineheight = 1,
           padding = margin(5.5, 5.5, 5.5, 5.5),
           margin = margin(0, 0, 5.5, 0))
         ,legend.title = element_blank() ) +
  ggtitle("<b>Rainfall by Month at PDX Airport (1941-2021) </b>") +
  labs(caption = "Data: National Centers for Environmental Information") +
  xlab('') +
  ylab('Monthly Rainfall (inches)\n')
```
